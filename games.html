<!-- games.html -->
<head>
  <title>One Night Werewolf</title>
</head>

<body>
  <div class="container">
    <header>
      <h1>One Night Werewolf</h1>
      {{> loginButtons}}
    </header>

    <ul>
      <li class="flow-list-item">Users</li>
      {{#each users}}
        <li class="flow-list-item"> {{username}} </li>
      {{/each}}
    </ul>
    {{#if currentUser}}
      <button class="add-game">Create New Game</button>
      <ul>
        <li>List of Games</li>
        {{#each games}}
          <li>Game: {{text}}
          Moderator: TBD
          State: TBD
          Day Timer: TBD
          Players: TBD
          Observers: TBD
          </li>

          <li> 
          <button class="toggle-join"> {{#if isPlayingThisGame}}Leave Game{{else}}Join Game{{/if}} </button>
          <button class="start-game">Start Game</button> 
          <button class="delete-game">Delete Game</button> 
          </li>

          <li> Players:
          {{#each players}}
            {{username}}
          {{/each}}
          </li>

          <li> Add Role:
          {{#each all_roles}}
            <button class="add-role" data-game="{{../_id}}">{{name}}</button>
          {{/each}}
          </li>

          <li>Current Roles:
          {{#each game_roles}}
            <button class="delete-role">{{name}}</button>
          {{/each}}
          </li>

          {{>gameState}}
          {{#if gameStateNotCreating}}
            {{#if myRole "Seer"    }} {{> seerNight  }} {{/if}}
            {{#if myRole "Werewolf"}} {{> wolfNight  }} {{/if}}
            {{#if myRole "Robber"  }} {{> robberNight}} {{/if}}
          {{/if}}
        {{/each}}
      </ul>
    {{/if}}
  </div>
</body>

<template name="gameState">
  <li>State: {{gameState}}</li>
  {{#if gameStateNotCreating}}
    <li>My Role: {{myRole}}</li>
    {{#if myinfo.example_game}}
      <li>Debug:
      {{#each players}}
        <li>{{username}}={{myinfo.orig_role}}={{debugResults}}</li>
      {{/each}}
      Unused Roles:
      {{#each myinfo.unused_roles}}
        {{name}}
      {{/each}}
      </li>
    {{/if}}
  {{/if}}
</template>

<template name="seerNight">
  <li>
    Seer Night Actions: <br>
    You are the Seer. Pick One player to Peek, or 2 cards from the middle. <br>
    Players:
    <form>
      {{#each players}}
        <input type="radio" name="player" value="{{this._id}}">{{username}}
      {{/each}}
      <input type="radio" name="player" value="middle" checked>2 cards from the middle
      <input type="submit" value="Submit">
    </form>
    <br>
    {{seerResults}}
  </li>
</template>

<template name="robberNight">
  <li>
    Robber Night Actions: <br>
    You are the Robber. Pick One player to Rob, or choose "Do not rob". <br>
    Players:
    <form>
      {{#each players}}
        <input type="radio" name="player" value="{{this._id}}">{{username}}
      {{/each}}
      <input type="radio" name="player" value="nobody" checked>Do not rob
      <input type="submit" value="Submit">
    </form>
    <br>
    {{robberResults}}
  </li>
</template>

<template name="wolfNight">
  <li>
    Wolf Night Actions: <br>
    {{wolfNightScript}}
  </li>
</template>
